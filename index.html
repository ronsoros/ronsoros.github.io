<html>
  <head>
    <title>codedump</title>
    <script src="https://cdn.jsdelivr.net/webtorrent/latest/webtorrent.min.js"></script>
    <script>
        function postcode() {
          var client = new WebTorrent();
          var file = new File([document.all('send').value], document.all('name').value);
          client.seed(file, function(torrent){ document.all('deliver').innerHTML = 'Link to posted file:\nhttp://ronsoros.github.io/?' + torrent.magnetURI });
        }
         function loaddoc(){
      var query = window.location.search.slice(1);
      if ( query != "" ) {
       document.all('deliver').innerHTML = "Loading...";
       var client = new WebTorrent();
        client.add(query, function (torrent) {
  // Torrents can contain many files. Let's use the first.
  var file = torrent.files[0]

  // Display the file by adding it to the DOM. Supports video, audio, image, etc. files
   var reader = new FileReader();
reader.addEventListener("loadend", function() {
   // reader.result contains the contents of blob as a typed array
  document.all('deliver').innerHTML = reader.result;
});
          file.getBlob(function(err,blob) {
reader.readAsText(blob);
          })
          });
      }
    }
    </script>
  </head>
  <body style='font-family: Arial; font-size: 14px;' onload="loaddoc()">
  <h1>codedump</h1>share code instantly
  <hr/>
    <xmp id='deliver' style='white-space: pre-wrap;'></xmp>
    <hr/>
    <h2>New Source File</h2>
    Name: <input type=text id='name'><br/>
    <textarea style='width:100%;height:300px' id='send'></textarea>
    <button onClick='postcode()'>Upload</button>
    <script>
 
    </script>
  </body>
</html>
  
